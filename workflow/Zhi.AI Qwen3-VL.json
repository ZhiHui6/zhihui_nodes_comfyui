{"id":"533e30e6-4615-4392-b6e9-26bb90a219b9","revision":0,"last_node_id":151,"last_link_id":188,"nodes":[{"id":109,"type":"Fast Groups Bypasser (rgthree)","pos":[-3440,-2410],"size":[280,90],"flags":{"pinned":true},"order":0,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"~","showNav":false,"showAllGraphs":false,"sort":"position","customSortAlphabet":"","toggleRestriction":"max one"}},{"id":127,"type":"Fast Groups Bypasser (rgthree)","pos":[-3440,-2280],"size":[280,90],"flags":{"pinned":true},"order":1,"mode":0,"inputs":[],"outputs":[{"label":"可选连接","name":"OPT_CONNECTION","type":"*","links":null}],"properties":{"matchColors":"","matchTitle":"#","showNav":false,"showAllGraphs":false,"sort":"position","customSortAlphabet":"","toggleRestriction":"max one"}},{"id":126,"type":"VideoLoader","pos":[-3090,-1820],"size":[310,440],"flags":{"pinned":true},"order":3,"mode":0,"inputs":[{"localized_name":"file","name":"file","type":"COMBO","widget":{"name":"file"},"link":null},{"localized_name":"upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"视频","localized_name":"视频","name":"VIDEO","type":"VIDEO","links":null},{"label":"路径","localized_name":"PATH","name":"PATH","type":"PATH","links":[135]}],"properties":{"Node name for S&R":"VideoLoader","aux_id":"ZhiHui6/zhihui_nodes_comfyui","ver":"96e4f1cfd665ecfa4d328241148840cf4115b108"},"widgets_values":["AnimateDiff_00024.mp4","image"],"color":"#323","bgcolor":"#535"},{"id":53,"type":"ModelDownloader","pos":[-3470,-1870],"size":[340,110],"flags":{"pinned":true},"order":4,"mode":4,"inputs":[{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"platform","name":"platform","type":"COMBO","widget":{"name":"platform"},"link":null},{"localized_name":"force_redownload","name":"force_redownload","type":"BOOLEAN","widget":{"name":"force_redownload"},"link":null}],"outputs":[{"label":"信息","localized_name":"info","name":"info","type":"STRING","links":[117]}],"properties":{"Node name for S&R":"ModelDownloader","aux_id":"ZhiHui6/zhihui_nodes_comfyui","ver":"762e73f880a74d8d779dd8a17f1a461648e81345"},"widgets_values":["Huihui-Qwen3-VL-8B-Instruct-abliterated","modelscope",false]},{"id":112,"type":"ShowText","pos":[-3470,-1700],"size":[340,330],"flags":{"pinned":true},"order":9,"mode":4,"inputs":[{"label":"文本","localized_name":"text","name":"text","type":"STRING","link":117}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":null}],"properties":{"Node name for S&R":"ShowText","aux_id":"ZhiHui6/zhihui_nodes_comfyui","ver":"7a53c5a332a03b72e60a3814821093b75a1b1589"},"widgets_values":["✅ 模型已存在，无需重新下载\n📁 模型路径: E:\\ComfyUI-Kaifa\\models\\prompt_generator\\Huihui-Qwen3-VL-8B-Instruct-abliterated\n💡 如需重新下载，请勾选'强制重新下载'选项"]},{"id":68,"type":"Note","pos":[-3470,-2100],"size":[340,170],"flags":{"pinned":true},"order":5,"mode":4,"inputs":[],"outputs":[],"properties":{},"widgets_values":["·如要使用Qwen3-VL Advanced请先安装潪AI节点包 ：https://github.com/ZhiHui6/zhihui_nodes_comfyui\n\n·运行Qwen3-VL Advanced节点前，需要先通过模型下载器下载所需模型。\n- 带“abliterated”标识的为破限版模型；\n- 带“Thinking”标识的为思考型模型（类似Deepseek R1）\n\n破限模型夸克网盘下载：\n[Huihui-Qwen3-VL-8B-abliterated]\nhttps://pan.quark.cn/s/750be7205985"],"color":"#432","bgcolor":"#653"},{"id":115,"type":"PathSwitch","pos":[-2750,-2250],"size":[260,150],"flags":{"pinned":true},"order":10,"mode":0,"inputs":[{"label":"路径1","localized_name":"Path_1","name":"Path_1","shape":7,"type":"PATH","link":172},{"label":"路径2","localized_name":"Path_2","name":"Path_2","shape":7,"type":"PATH","link":135},{"localized_name":"mode","name":"mode","type":"COMBO","widget":{"name":"mode"},"link":null},{"localized_name":"select_channel","name":"select_channel","type":"COMBO","widget":{"name":"select_channel"},"link":null},{"localized_name":"Path_1_comment","name":"Path_1_comment","shape":7,"type":"STRING","widget":{"name":"Path_1_comment"},"link":null},{"localized_name":"Path_2_comment","name":"Path_2_comment","shape":7,"type":"STRING","widget":{"name":"Path_2_comment"},"link":null}],"outputs":[{"label":"输出路径","localized_name":"output_path","name":"output_path","type":"PATH","links":[130]}],"properties":{"Node name for S&R":"PathSwitch","aux_id":"ZhiHui6/zhihui_nodes_comfyui","ver":"96e4f1cfd665ecfa4d328241148840cf4115b108"},"widgets_values":["auto","1","图像加载器","视频加载器"]},{"id":144,"type":"ImageLoader","pos":[-3090,-2250],"size":[310,334],"flags":{"pinned":true},"order":6,"mode":0,"inputs":[{"localized_name":"image","name":"image","type":"COMBO","widget":{"name":"image"},"link":null},{"localized_name":"upload","name":"upload","type":"IMAGEUPLOAD","widget":{"name":"upload"},"link":null}],"outputs":[{"label":"路径","localized_name":"image_path","name":"image_path","type":"PATH","links":[172]},{"localized_name":"image","name":"image","type":"IMAGE","links":null},{"localized_name":"mask","name":"mask","type":"MASK","links":null}],"properties":{"Node name for S&R":"ImageLoader"},"widgets_values":["Cosplay Yuuhui玉汇 街头霸王 春丽 Set.01-018.jpg","image"],"color":"#232","bgcolor":"#353"},{"id":116,"type":"MultiplePathsInput","pos":[-2750,-2040],"size":[260,90],"flags":{"pinned":true},"order":11,"mode":0,"inputs":[{"label":"路径1","localized_name":"path_1","name":"path_1","type":"PATH","link":130},{"localized_name":"inputcount","name":"inputcount","type":"INT","widget":{"name":"inputcount"},"link":null}],"outputs":[{"label":"路径列表","localized_name":"paths","name":"paths","type":"PATH","links":[188]}],"properties":{"Node name for S&R":"MultiplePathsInput","aux_id":"ZhiHui6/zhihui_nodes_comfyui","ver":"762e73f880a74d8d779dd8a17f1a461648e81345"},"widgets_values":[1]},{"id":69,"type":"Note","pos":[-2460,-2260],"size":[670,90],"flags":{"pinned":true},"order":7,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["·如需批量打标功能，请先打开batch_modea按钮，并设置忽略source_path输入端口上游的节点，然后在batch_directory填入需要打标的数据集路径。\n\n·若使用提示预设，preset_prompt设为所需选项即可。选择预设后，user_prompt的内容将被忽略。"],"color":"#432","bgcolor":"#653"},{"id":134,"type":"Qwen3VLExtraOptions","pos":[-2460,-2110],"size":[322.783203125,730],"flags":{"pinned":true},"order":2,"mode":0,"inputs":[{"localized_name":"extra_options_control","name":"extra_options_control","type":"COMBO","widget":{"name":"extra_options_control"},"link":null},{"localized_name":"refer_character_name","name":"refer_character_name","type":"BOOLEAN","widget":{"name":"refer_character_name"},"link":null},{"localized_name":"exclude_people_info","name":"exclude_people_info","type":"BOOLEAN","widget":{"name":"exclude_people_info"},"link":null},{"localized_name":"include_lighting","name":"include_lighting","type":"BOOLEAN","widget":{"name":"include_lighting"},"link":null},{"localized_name":"include_camera_angle","name":"include_camera_angle","type":"BOOLEAN","widget":{"name":"include_camera_angle"},"link":null},{"localized_name":"include_watermark","name":"include_watermark","type":"BOOLEAN","widget":{"name":"include_watermark"},"link":null},{"localized_name":"include_JPEG_artifacts","name":"include_JPEG_artifacts","type":"BOOLEAN","widget":{"name":"include_JPEG_artifacts"},"link":null},{"localized_name":"include_exif","name":"include_exif","type":"BOOLEAN","widget":{"name":"include_exif"},"link":null},{"localized_name":"exclude_sexual","name":"exclude_sexual","type":"BOOLEAN","widget":{"name":"exclude_sexual"},"link":null},{"localized_name":"exclude_image_resolution","name":"exclude_image_resolution","type":"BOOLEAN","widget":{"name":"exclude_image_resolution"},"link":null},{"localized_name":"include_aesthetic_quality","name":"include_aesthetic_quality","type":"BOOLEAN","widget":{"name":"include_aesthetic_quality"},"link":null},{"localized_name":"include_composition_style","name":"include_composition_style","type":"BOOLEAN","widget":{"name":"include_composition_style"},"link":null},{"localized_name":"exclude_text","name":"exclude_text","type":"BOOLEAN","widget":{"name":"exclude_text"},"link":null},{"localized_name":"specify_depth_field","name":"specify_depth_field","type":"BOOLEAN","widget":{"name":"specify_depth_field"},"link":null},{"localized_name":"specify_lighting_sources","name":"specify_lighting_sources","type":"BOOLEAN","widget":{"name":"specify_lighting_sources"},"link":null},{"localized_name":"do_not_use_ambiguous_language","name":"do_not_use_ambiguous_language","type":"BOOLEAN","widget":{"name":"do_not_use_ambiguous_language"},"link":null},{"localized_name":"include_nsfw","name":"include_nsfw","type":"BOOLEAN","widget":{"name":"include_nsfw"},"link":null},{"localized_name":"only_describe_most_important_elements","name":"only_describe_most_important_elements","type":"BOOLEAN","widget":{"name":"only_describe_most_important_elements"},"link":null},{"localized_name":"do_not_include_artist_name_or_title","name":"do_not_include_artist_name_or_title","type":"BOOLEAN","widget":{"name":"do_not_include_artist_name_or_title"},"link":null},{"localized_name":"identify_image_orientation","name":"identify_image_orientation","type":"BOOLEAN","widget":{"name":"identify_image_orientation"},"link":null},{"localized_name":"use_vulgar_slang_and_profanity","name":"use_vulgar_slang_and_profanity","type":"BOOLEAN","widget":{"name":"use_vulgar_slang_and_profanity"},"link":null},{"localized_name":"do_not_use_polite_euphemisms","name":"do_not_use_polite_euphemisms","type":"BOOLEAN","widget":{"name":"do_not_use_polite_euphemisms"},"link":null},{"localized_name":"include_character_age","name":"include_character_age","type":"BOOLEAN","widget":{"name":"include_character_age"},"link":null},{"localized_name":"include_camera_shot_type","name":"include_camera_shot_type","type":"BOOLEAN","widget":{"name":"include_camera_shot_type"},"link":null},{"localized_name":"exclude_mood_feeling","name":"exclude_mood_feeling","type":"BOOLEAN","widget":{"name":"exclude_mood_feeling"},"link":null},{"localized_name":"include_camera_vantage_height","name":"include_camera_vantage_height","type":"BOOLEAN","widget":{"name":"include_camera_vantage_height"},"link":null},{"localized_name":"mention_watermark","name":"mention_watermark","type":"BOOLEAN","widget":{"name":"mention_watermark"},"link":null},{"localized_name":"avoid_meta_descriptive_phrases","name":"avoid_meta_descriptive_phrases","type":"BOOLEAN","widget":{"name":"avoid_meta_descriptive_phrases"},"link":null},{"localized_name":"character_name","name":"character_name","type":"STRING","widget":{"name":"character_name"},"link":null}],"outputs":[{"label":"额外选项","localized_name":"extra_options","name":"extra_options","type":"QWEN3VL_EXTRA_OPTIONS","links":[187]}],"properties":{"Node name for S&R":"Qwen3VLExtraOptions"},"widgets_values":["Disable",false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,""]},{"id":151,"type":"Qwen3VLAdvanced","pos":[-2130,-2110],"size":[340,730],"flags":{"pinned":true},"order":12,"mode":0,"inputs":[{"label":"额外选项","localized_name":"extra_options","name":"extra_options","shape":7,"type":"QWEN3VL_EXTRA_OPTIONS","link":187},{"label":"源路径","localized_name":"source_path","name":"source_path","shape":7,"type":"PATH","link":188},{"label":"图像","localized_name":"image","name":"image","shape":7,"type":"IMAGE","link":null},{"localized_name":"preset_prompt","name":"preset_prompt","type":"COMBO","widget":{"name":"preset_prompt"},"link":null},{"localized_name":"output_language","name":"output_language","type":"COMBO","widget":{"name":"output_language"},"link":null},{"localized_name":"user_prompt","name":"user_prompt","type":"STRING","widget":{"name":"user_prompt"},"link":null},{"localized_name":"system_prompt","name":"system_prompt","type":"STRING","widget":{"name":"system_prompt"},"link":null},{"localized_name":"remove_think_tags","name":"remove_think_tags","type":"BOOLEAN","widget":{"name":"remove_think_tags"},"link":null},{"localized_name":"unlock_restrictions","name":"unlock_restrictions","type":"COMBO","widget":{"name":"unlock_restrictions"},"link":null},{"localized_name":"model","name":"model","type":"COMBO","widget":{"name":"model"},"link":null},{"localized_name":"quantization","name":"quantization","type":"COMBO","widget":{"name":"quantization"},"link":null},{"localized_name":"temperature","name":"temperature","type":"FLOAT","widget":{"name":"temperature"},"link":null},{"localized_name":"top_p","name":"top_p","type":"FLOAT","widget":{"name":"top_p"},"link":null},{"localized_name":"num_beams","name":"num_beams","type":"INT","widget":{"name":"num_beams"},"link":null},{"localized_name":"repetition_penalty","name":"repetition_penalty","type":"FLOAT","widget":{"name":"repetition_penalty"},"link":null},{"localized_name":"frame_count","name":"frame_count","type":"INT","widget":{"name":"frame_count"},"link":null},{"localized_name":"max_new_tokens","name":"max_new_tokens","type":"INT","widget":{"name":"max_new_tokens"},"link":null},{"localized_name":"min_resolution","name":"min_resolution","type":"INT","widget":{"name":"min_resolution"},"link":null},{"localized_name":"max_resolution","name":"max_resolution","type":"INT","widget":{"name":"max_resolution"},"link":null},{"localized_name":"seed","name":"seed","type":"INT","widget":{"name":"seed"},"link":null},{"localized_name":"attention","name":"attention","type":"COMBO","widget":{"name":"attention"},"link":null},{"localized_name":"device","name":"device","type":"COMBO","widget":{"name":"device"},"link":null},{"localized_name":"keep_model_loaded","name":"keep_model_loaded","type":"BOOLEAN","widget":{"name":"keep_model_loaded"},"link":null},{"localized_name":"batch_mode","name":"batch_mode","type":"BOOLEAN","widget":{"name":"batch_mode"},"link":null},{"localized_name":"batch_directory","name":"batch_directory","type":"STRING","widget":{"name":"batch_directory"},"link":null}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","type":"STRING","links":[186]}],"properties":{"Node name for S&R":"Qwen3VLAdvanced"},"widgets_values":["Ignore","Ignore","","",false,"Disable","Qwen3-VL-8B-Instruct","8bit",0.7,0.9,1,1.2,23,1024,256,768,-1,"randomize","sdpa","auto",false,false,""]},{"id":147,"type":"ShowText","pos":[-1760,-2250],"size":[590,870],"flags":{"pinned":true},"order":13,"mode":0,"inputs":[{"label":"文本","localized_name":"text","name":"text","type":"STRING","link":186}],"outputs":[{"label":"字符串","localized_name":"字符串","name":"STRING","shape":6,"type":"STRING","links":null}],"properties":{"Node name for S&R":"ShowText"},"widgets_values":[]},{"id":150,"type":"MarkdownNote","pos":[-4340,-2450],"size":[850,1080],"flags":{"pinned":true},"order":8,"mode":0,"inputs":[],"outputs":[],"properties":{},"widgets_values":["# Qwen3VLAdvanced 节点参数说明表格\n\n## 基础参数\n| 参数名称 | 默认值 | 建议值 | 参数调节范围 | 参数说明 |\n|---------|--------|--------|-------------|----------|\n| preset_prompt | Ignore | [Prompt Style]Detailed | 预设选项 | 选择预设的提示词模板，包含标签生成、详细描述、创意分析等多种模式 |\n| output_language | Ignore | Chinese | Ignore/Chinese/english/Chinese&English | 设置输出语言，可选择中文、英文或双语输出 |\n| user_prompt | 无 | 根据需求自定义 | 任意文本 | 用户自定义的提示词，用于指导模型生成特定内容 |\n| system_prompt |无  | 根据角色设定 | 任意文本 | 系统级提示词，用于设定模型的行为模式和角色定位 |\n| remove_think_tags | False | True (使用Thinking模型时) | True/False | 启用后将删除输出文本中</think>标签及其之前的所有内容，保留纯净的描述文本。仅对Thinking模型有效 |\n| unlock_restrictions | Disable | Disable | Disable/Unlock_Instruction_A/Unlock_Instruction_B | 解锁模型限制，提供不同级别的内容生成自由度。谨慎使用，可能产生不当内容 |\n\n## 模型相关参数\n| 参数名称 | 默认值 | 建议值 | 参数调节范围 | 参数说明 |\n|---------|--------|--------|-------------|----------|\n| model | Qwen3-VL-8B-Instruct | Qwen3-VL-8B-Instruct | 5种模型选项 | 选择Qwen3-VL模型版本，包含4B/8B参数量和Instruct/Thinking两种类型 |\n| quantization | 8bit | 8bit | none/4bit/8bit | 模型量化设置，降低显存占用。8bit平衡性能与资源，4bit更节省显存但可能影响质量 |\n\n## 生成参数\n| 参数名称 | 默认值 | 建议值 | 参数调节范围 | 参数说明 |\n|---------|--------|--------|-------------|----------|\n| temperature | 0.7 | 0.7-0.9 | 0.0-1.0 | 控制生成文本的随机性，值越高越有创意，值越低越保守稳定 |\n| top_p | 0.9 | 0.8-0.95 | 0.0-1.0 | 核采样参数，控制词汇选择范围，较小值使输出更集中，较大值增加多样性 |\n| num_beams | 1 | 1-3 | 1-10 | 束搜索数量，值大于1时启用束搜索，可提高输出质量但增加计算时间 |\n| repetition_penalty | 1.2 | 1.1-1.3 | 0.1-2.0 | 重复惩罚系数，防止生成重复内容，值越大越避免重复 |\n| frame_count | 23 | 16-32 | 1-64 | 视频处理时的帧数量，影响视频理解的精度和处理速度 |\n| max_new_tokens | 1024 | 512-2048 | 128-8192 | 生成文本的最大长度，值越大可生成越长的内容但消耗更多资源 |\n\n## 高级参数\n| 参数名称 | 默认值 | 建议值 | 参数调节范围 | 参数说明 |\n|---------|--------|--------|-------------|----------|\n| seed | -1 | -1 (随机) | -1或任意正整数 | 随机种子，设置为-1使用随机值，固定值可确保结果可重现。测试时建议固定值 |\n| attention | sdpa | sdpa | eager/sdpa/flash_attention_2 | 注意力机制类型。eager(兼容性好)、sdpa(平衡性能，推荐)、flash_attention_2(最快，需A100/H100) |\n| device | auto | auto | auto/gpu/cpu | 计算设备选择，auto自动选择最佳设备，gpu使用显卡加速，cpu使用处理器(慢但兼容性好) |\n| keep_model_loaded | False | True (频繁使用时) | True/False | 保持模型在内存中，启用后可加快后续推理速度但占用更多显存。批量处理时建议启用 |\n| batch_mode | False | False | True/False | 批处理模式，启用后可批量处理指定目录下的所有图像文件，自动保存描述文件 |\n| batch_directory | 无 | 具体目录路径 | 任意有效路径 | 批处理目录路径，指定要批量处理的图像文件所在目录。支持jpg、png、webp等格式 |\n\n## 可选输入参数\n| 参数名称 | 类型 | 参数说明 |\n|---------|------|----------|\n| extra_options | QWEN3VL_EXTRA_OPTIONS | 额外选项配置，可通过专用节点提供更多高级设置 |\n| source_path | PATH | 图像或视频文件路径，可替代image输入，支持本地文件路径 |\n| image | IMAGE | 图像输入，支持ComfyUI标准图像格式，与source_path二选一 |"],"color":"#432","bgcolor":"#653"}],"links":[[117,53,0,112,0,"STRING"],[130,115,0,116,0,"PATH"],[135,126,1,115,1,"PATH"],[172,144,0,115,0,"PATH"],[186,151,0,147,0,"STRING"],[187,134,0,151,0,"QWEN3VL_EXTRA_OPTIONS"],[188,116,0,151,1,"PATH"]],"groups":[{"id":1,"title":"🔽1.模型下载~","bounding":[-3480,-2170,360,810],"color":"#A88","font_size":24,"flags":{"pinned":true}},{"id":10,"title":"👁️视觉推理 / 打标 / 反推~","bounding":[-3110,-2380,1960,1020],"color":"#3f789e","font_size":24,"flags":{"pinned":true}},{"id":2,"title":"⚙️4.推理设置","bounding":[-2470,-2340,690,970],"color":"#3f789e","font_size":24,"flags":{"pinned":true}},{"id":3,"title":"🖼️2a.加载图像#","bounding":[-3100,-2340,330,420],"color":"#3f789e","font_size":24,"flags":{"pinned":true}},{"id":5,"title":"🔗3.路径切换","bounding":[-2760,-2340,280,400],"color":"#3f789e","font_size":24,"flags":{"pinned":true}},{"id":6,"title":"📄5.文本结果","bounding":[-1770,-2340,610,970],"color":"#8A8","font_size":24,"flags":{"pinned":true}},{"id":7,"title":"👩🏻‍💻潪AI Qwen3-VL 高级版视觉识别多用途工作流","bounding":[-3110,-2480,1470,90],"color":"#ffffff","font_size":64,"flags":{"pinned":true}},{"id":8,"title":"🔌节点开关","bounding":[-3480,-2480,360,300],"color":"#b58b2a","font_size":24,"flags":{"pinned":true}},{"id":9,"title":"🖼️2b.加载视频#","bounding":[-3100,-1910,330,540],"color":"#3f789e","font_size":24,"flags":{"pinned":true}}],"config":{},"extra":{"ds":{"scale":0.7627768444386168,"offset":[4724.233904255925,2843.820959773275]},"frontendVersion":"1.28.7","VHS_latentpreview":true,"VHS_latentpreviewrate":0,"VHS_MetadataImage":true,"VHS_KeepIntermediate":true},"version":0.4}